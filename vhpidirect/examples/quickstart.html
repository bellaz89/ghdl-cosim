

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick Start &mdash; GHDL-cosim latest documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Wrapping" href="wrapping.html" />
    <link rel="prev" title="Examples" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> GHDL-cosim
          

          
          </a>

          
            
            
              <div class="version">
                latest
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">VHPIDIRECT</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../declarations.html">Type declarations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wrapping.html">Wrapping a simulation (ghdl_main)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../linking.html">Linking object files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dynamic.html">Dynamic loading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../grt.html">Using GRT</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#random">random</a></li>
<li class="toctree-l3"><a class="reference internal" href="#math">math</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customc">customc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package">package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sharedvar">sharedvar</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="wrapping.html">Wrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="linking.html">Linking</a></li>
<li class="toctree-l2"><a class="reference internal" href="shared.html">Shared</a></li>
<li class="toctree-l2"><a class="reference internal" href="arrays.html">Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="other.html">Other co-simulation projects</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">VPI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../vpi/examples/index.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GHDL-cosim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Examples</a> &raquo;</li>
        
      <li>Quick Start</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/vhpidirect/examples/quickstart.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-start">
<span id="cosim-vhpidirect-examples-quickstart"></span><h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<div class="section" id="random">
<span id="cosim-vhpidirect-examples-quickstart-random"></span><h2><a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/random">random</a><a class="headerlink" href="#random" title="Permalink to this headline">¶</a></h2>
<p>By default, GHDL includes the standard C library in the generated simulation models. Hence, resources from <code class="docutils literal notranslate"><span class="pre">stdlib</span></code> can be used without any modification to the build procedure.</p>
<p>This example shows how to import and use <code class="docutils literal notranslate"><span class="pre">rand</span></code> to generate and print 10 integer numbers. The VHDL code is equivalent to the following C snippet. However, note that this C source is NOT required, because <code class="docutils literal notranslate"><span class="pre">stdlib</span></code> is already built in.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">printf</span> <span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">rand</span> <span class="p">());</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="math">
<span id="cosim-vhpidirect-examples-quickstart-math"></span><h2><a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/math">math</a><a class="headerlink" href="#math" title="Permalink to this headline">¶</a></h2>
<p>By the same token, it is possible to include functions from system library by just providing the corresponding linker
flag.</p>
<p>In this example, function <code class="docutils literal notranslate"><span class="pre">sin</span></code> from the <code class="docutils literal notranslate"><span class="pre">math</span></code> library is used to compute 10 values. As in the previous example,
no additional C sources are required, because the <code class="docutils literal notranslate"><span class="pre">math</span></code> library is already compiled and installed in the system.</p>
</div>
<div class="section" id="customc">
<span id="cosim-vhpidirect-examples-quickstart-customc"></span><h2><a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/customc">customc</a><a class="headerlink" href="#customc" title="Permalink to this headline">¶</a></h2>
<p>When the required functionality is not available in pre-built libraries, custom C sources and/or objects can be added
to the elaboration and/or linking.</p>
<p>This example shows how to bind custom C functions in VHDL as either procedures or functions. Four cases are included:
<code class="docutils literal notranslate"><span class="pre">custom_procedure</span></code>, <code class="docutils literal notranslate"><span class="pre">custom_procedure_withargs</span></code>, <code class="docutils literal notranslate"><span class="pre">custom_function</span></code> and <code class="docutils literal notranslate"><span class="pre">custom_function_withargs</span></code>. In all
cases, the parameters are defined as integers, in order to keep it simple. See <a class="reference internal" href="../declarations.html#cosim-vhpidirect-declarations"><span class="std std-ref">Type declarations</span></a>
for further details.</p>
<p>Since either C sources or pre-compiled <code class="docutils literal notranslate"><span class="pre">.o</span></code> objects can be added, in C/C++ projects of moderate complexity, it might
be desirable to merge all the C sources in a single object before elaborating the design.</p>
</div>
<div class="section" id="package">
<span id="cosim-vhpidirect-examples-quickstart-package"></span><h2><a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/package">package</a><a class="headerlink" href="#package" title="Permalink to this headline">¶</a></h2>
<p>If the auxillary VHPIDIRECT subprograms need to be accessed in more than one entity, it is possible to package the
subprograms. This also makes it very easy to reuse the VHPIDIRECT declarations in different projects.</p>
<p>In this example two different entities use a C defined <code class="docutils literal notranslate"><span class="pre">c_printInt(val:</span> <span class="pre">integer)</span></code> subprogram to print two different
numbers. Subprogram declaration requirements are detailed under the <a class="reference internal" href="../declarations.html#cosim-vhpidirect-declarations"><span class="std std-ref">Type declarations</span></a> section.</p>
</div>
<div class="section" id="sharedvar">
<span id="cosim-vhpidirect-examples-quickstart-sharedvar"></span><h2><a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/sharedvar">sharedvar</a><a class="headerlink" href="#sharedvar" title="Permalink to this headline">¶</a></h2>
<p>While sharing variables through packages in VHDL 1993 is flexible, in VHDL 2008 protected types need to be used.
However, GHDL allows to relax some rules of the LRM through <a class="reference external" href="https://ghdl.readthedocs.io/en/latest/using/InvokingGHDL.html#cmdoption-ghdl-frelaxed" title="(in GHDL v1.0-dev)"><code class="xref std std-option docutils literal notranslate"><span class="pre">-frelaxed</span></code></a>.</p>
<p>This example shows multiple alternatives to share variables through packages, depending on the target version of the standard.
Three different binaries are built from the same entity, using:</p>
<blockquote>
<div><ul class="simple">
<li><p>A VHDL 1993 package with <code class="docutils literal notranslate"><span class="pre">--std=93</span></code>.</p></li>
<li><p>A VHDL 1993 package with <code class="docutils literal notranslate"><span class="pre">--std=08</span> <span class="pre">-frelaxed</span></code>.</p></li>
<li><p>A VHDL 2008 package with <code class="docutils literal notranslate"><span class="pre">--std=08</span></code>.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Procedure <code class="docutils literal notranslate"><span class="pre">setVar</span></code> is not strictly required. It is used to allow the same descriptions of the entity/architectures
to work with both VHDL 1993 and VHDL 2008. See the bodies of the procedure in <a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/sharedvar/pkg_93.vhd">pkg_93.vhd</a> and <a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/sharedvar/pkg_08.vhd">pkg_08.vhd</a>.</p>
</div>
<p>As an alternative to using a shared variable in VHDL, subdir <a class="reference external" href="https://github.com/ghdl/ghdl-cosim/blob/master/vhpidirect/quickstart/sharedvar/shint">shint</a>
contains an approach based on a helper record type which is used as a handle. Mimicking the concept of <em>methods</em> from
Object Oriented (OO) programming, helper C functions are used to read/write the actual variables, instead of sharing
data through an access/pointer. This approach is more verbose than others, but it works with either VHDL 1993 or VHDL
2008 without modification and without requiring <a class="reference external" href="https://ghdl.readthedocs.io/en/latest/using/InvokingGHDL.html#cmdoption-ghdl-frelaxed" title="(in GHDL v1.0-dev)"><code class="xref std std-option docutils literal notranslate"><span class="pre">-frelaxed</span></code></a>. Moreover, it enhances encapsulation, as it provides
a user-defined API between VHDL and C, which can improve maintainability when sources are reused. As a matter of fact,
this approach is found in verification projects such as <a class="reference external" href="http://vunit.github.io/">VUnit</a> and <a class="reference external" href="https://osvvm.org/">OSVVM</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="wrapping.html" class="btn btn-neutral float-right" title="Wrapping" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Tristan Gingold and contributors

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>